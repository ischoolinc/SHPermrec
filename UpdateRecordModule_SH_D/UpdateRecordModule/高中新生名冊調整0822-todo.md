# é«˜ä¸­æ–°ç”Ÿåå†Šèª¿æ•´ 0822 - Todo æ¸…å–®

## å°ˆæ¡ˆè³‡è¨Š
- **å°ˆæ¡ˆåç¨±**: SHPermrec\UpdateRecordModule_SH_D\UpdateRecordModule
- **æª”æ¡ˆè·¯å¾‘**: `Resources\EnrollmentListTemplate.xlsx`
- **è¨˜éŒ„æ—¥æœŸ**: 2025å¹´8æœˆ22æ—¥
- **ç‹€æ…‹**: å¾…è™•ç†

---

## Todo 1: ä¿®æ­£ EnrollmentList2021.cs ç¬¬520-532è¡Œè¨ˆç®—éŒ¯èª¤é¢¨éšª

### å•é¡Œæè¿°
`EnrollmentList2021.cs` ç¬¬520è‡³532è¡Œå­˜åœ¨åš´é‡çš„è¨ˆç®—é‚è¼¯éŒ¯èª¤é¢¨éšªï¼Œä¸»è¦å•é¡Œæ˜¯è®Šæ•¸ `extra` è¢«é‡è¤‡ä½¿ç”¨ï¼Œå°è‡´è¨ˆç®—çµæœä¸æ­£ç¢ºã€‚

### å•é¡Œä½ç½®
- **æª”æ¡ˆ**: `GovernmentalDocument/Reports/List/EnrollmentList2021.cs`
- **è¡Œæ•¸**: ç¬¬520-532è¡Œ
- **å‡½æ•¸**: `Build` æ–¹æ³•å…§

### å…·é«”å•é¡Œåˆ†æ

#### 1. è®Šæ•¸é‡ç”¨é¢¨éšª
```csharp
// ç¬¬520-525è¡Œï¼šè¨ˆç®—å¤–åŠ å­¸ç”Ÿç¸½æ•¸
int extra = 0;
if (int.TryParse(extraStudent1, out in_temp)) extra += in_temp;
if (int.TryParse(extraStudent2, out in_temp)) extra += in_temp;
if (int.TryParse(extraStudent3, out in_temp)) extra += in_temp;

// ç¬¬526è¡Œï¼šè¨ˆç®—ä¸€èˆ¬ç”Ÿäººæ•¸ï¼ˆé€™å€‹è¨ˆç®—é‚è¼¯æ˜¯éŒ¯èª¤çš„ï¼‰
generalStudentCount = actualStudentCount - extra;

// ç¬¬527-530è¡Œï¼šé‡æ–°è¨ˆç®—è¶…æ”¶å­¸ç”Ÿæ•¸ï¼ˆè¦†è“‹äº†å¤–åŠ å­¸ç”Ÿç¸½æ•¸ï¼Œä¸”å…¬å¼éŒ¯èª¤ï¼‰
extra = generalStudentCount - (approvedClassCount * approvedStudentCount);
```

**æ­£ç¢ºçš„è¨ˆç®—é‚è¼¯æ‡‰è©²æ˜¯**ï¼š
```csharp
// æ­£ç¢ºå…¬å¼ï¼šå¯¦æ‹›æ–°ç”Ÿæ•¸ - å¤–åŠ éŒ„å–åŸä½æ°‘ - å¤–åŠ éŒ„å–èº«å¿ƒéšœç¤™ç”Ÿ - å¤–åŠ éŒ„å–å…¶ä»– - æ ¸å®šç­æ•¸ Ã— æ ¸å®šå­¸ç”Ÿæ•¸
overEnrollment = actualStudentCount - extraStudents - (approvedClassCount * approvedStudentCount);
```

#### 2. é‚è¼¯éŒ¯èª¤
- **ç¬¬520-525è¡Œ**: `extra` è®Šæ•¸ä»£è¡¨ã€Œå¤–åŠ å­¸ç”Ÿç¸½æ•¸ã€
- **ç¬¬526è¡Œ**: éŒ¯èª¤åœ°è¨ˆç®—ã€Œä¸€èˆ¬ç”Ÿäººæ•¸ã€ï¼ˆé€™å€‹æ¦‚å¿µåœ¨æ­£ç¢ºå…¬å¼ä¸­ä¸éœ€è¦ï¼‰
- **ç¬¬527-530è¡Œ**: `extra` è®Šæ•¸è¢«é‡æ–°è³¦å€¼ç‚ºã€Œè¶…æ”¶å­¸ç”Ÿæ•¸ã€ï¼Œä¸”ä½¿ç”¨éŒ¯èª¤çš„è¨ˆç®—å…¬å¼
- **çµæœ**: è®Šæ•¸å«ç¾©ä¸ä¸€è‡´ï¼Œé‚è¼¯æ··äº‚ï¼Œè¨ˆç®—å…¬å¼éŒ¯èª¤

#### 3. è¨ˆç®—å…¬å¼éŒ¯èª¤
- **åŸå§‹éŒ¯èª¤å…¬å¼**: å…ˆè¨ˆç®—ä¸€èˆ¬ç”Ÿäººæ•¸ï¼Œå†ç”¨ä¸€èˆ¬ç”Ÿäººæ•¸æ¸›å»æ ¸å®šå®¹é‡
- **æ­£ç¢ºå…¬å¼**: å¯¦æ‹›æ–°ç”Ÿæ•¸ - å¤–åŠ éŒ„å–åŸä½æ°‘ - å¤–åŠ éŒ„å–èº«å¿ƒéšœç¤™ç”Ÿ - å¤–åŠ éŒ„å–å…¶ä»– - æ ¸å®šç­æ•¸ Ã— æ ¸å®šå­¸ç”Ÿæ•¸
- **å·®ç•°**: ä¸éœ€è¦å…ˆè¨ˆç®—ä¸€èˆ¬ç”Ÿäººæ•¸ï¼Œç›´æ¥å¾å¯¦æ‹›æ–°ç”Ÿæ•¸ä¸­æ¸›å»æ‰€æœ‰é …ç›®å³å¯

#### 3. è³‡æ–™ä¸ä¸€è‡´
- æœ€çµ‚å¡«å…¥ Excel çš„ `extra` å€¼èˆ‡åŸå§‹å¤–åŠ å­¸ç”Ÿæ¦‚å¿µä¸ç¬¦
- å¯èƒ½å°è‡´å ±è¡¨è³‡æ–™éŒ¯èª¤

### å½±éŸ¿ç¯„åœ
- **æ–°ç”Ÿåå†Šçµ±è¨ˆè¡¨**: å¤–åŠ å­¸ç”Ÿæ•¸å’Œè¶…æ”¶å­¸ç”Ÿæ•¸å¯èƒ½è¨ˆç®—éŒ¯èª¤
- **è³‡æ–™å®Œæ•´æ€§**: å½±éŸ¿æ”¿åºœå ±è¡¨çš„æº–ç¢ºæ€§
- **ç¶­è­·æ€§**: ç¨‹å¼ç¢¼é›£ä»¥ç†è§£å’Œç¶­è­·

### ä¿®æ­£ç›®æ¨™
1. ä½¿ç”¨ä¸åŒçš„è®Šæ•¸åç¨±å€åˆ†ä¸åŒæ¦‚å¿µ
2. **ä¿®æ­£è¨ˆç®—å…¬å¼ç‚ºæ­£ç¢ºé‚è¼¯**ï¼šå¯¦æ‹›æ–°ç”Ÿæ•¸ - å¤–åŠ éŒ„å–åŸä½æ°‘ - å¤–åŠ éŒ„å–èº«å¿ƒéšœç¤™ç”Ÿ - å¤–åŠ éŒ„å–å…¶ä»– - æ ¸å®šç­æ•¸ Ã— æ ¸å®šå­¸ç”Ÿæ•¸
3. ç§»é™¤ä¸å¿…è¦çš„ã€Œä¸€èˆ¬ç”Ÿäººæ•¸ã€è¨ˆç®—æ­¥é©Ÿ
4. ç¢ºä¿è¨ˆç®—é‚è¼¯æ¸…æ™°æ­£ç¢º
5. æé«˜ç¨‹å¼ç¢¼å¯è®€æ€§å’Œç¶­è­·æ€§
6. é¿å…è³‡æ–™è¨ˆç®—éŒ¯èª¤

### å»ºè­°ä¿®æ­£æ–¹æ¡ˆ
```csharp
// å»ºè­°çš„ä¿®æ­£ç‰ˆæœ¬
int extraStudents = 0;        // å¤–åŠ å­¸ç”Ÿç¸½æ•¸
int overEnrollment = 0;      // è¶…æ”¶å­¸ç”Ÿæ•¸

// è¨ˆç®—å¤–åŠ å­¸ç”Ÿç¸½æ•¸
if (int.TryParse(extraStudent1, out in_temp)) extraStudents += in_temp;
if (int.TryParse(extraStudent2, out in_temp)) extraStudents += in_temp;
if (int.TryParse(extraStudent3, out in_temp)) extraStudents += in_temp;

// ç›´æ¥è¨ˆç®—è¶…æ”¶å­¸ç”Ÿæ•¸ï¼ˆä½¿ç”¨æ­£ç¢ºå…¬å¼ï¼‰
if (int.TryParse(actualStudentCount, out in_temp) && 
    int.TryParse(approvedClassCount, out int approvedClass) && 
    int.TryParse(approvedStudentCount, out int approvedStudent))
{
    // æ­£ç¢ºå…¬å¼ï¼šå¯¦æ‹›æ–°ç”Ÿæ•¸ - å¤–åŠ éŒ„å–åŸä½æ°‘ - å¤–åŠ éŒ„å–èº«å¿ƒéšœç¤™ç”Ÿ - å¤–åŠ éŒ„å–å…¶ä»– - æ ¸å®šç­æ•¸ Ã— æ ¸å®šå­¸ç”Ÿæ•¸
    overEnrollment = in_temp - extraStudents - (approvedClass * approvedStudent);
}

// ç¢ºä¿è¶…æ”¶æ•¸ä¸ç‚ºè² æ•¸
if (overEnrollment < 0) overEnrollment = 0;

// å¡«å…¥ Excel æ™‚ä½¿ç”¨æ­£ç¢ºçš„è®Šæ•¸
StaticSheet.Cells[cover_row_counter, 5].PutValue(extraStudent1);      // å¤–åŠ éŒ„å–åŸä½æ°‘
StaticSheet.Cells[cover_row_counter, 6].PutValue(extraStudent2);      // å¤–åŠ éŒ„å–èº«å¿ƒéšœç¤™ç”Ÿ
StaticSheet.Cells[cover_row_counter, 7].PutValue(extraStudent3);      // å¤–åŠ éŒ„å–å…¶ä»–
StaticSheet.Cells[cover_row_counter, 8].PutValue(overEnrollment);     // è¶…æ”¶å­¸ç”Ÿæ•¸
```

### å„ªå…ˆç´š
- **ç­‰ç´š**: ğŸ”´ é«˜å„ªå…ˆç´š
- **åŸå› **: æ¶‰åŠè³‡æ–™è¨ˆç®—éŒ¯èª¤ï¼Œå¯èƒ½å½±éŸ¿æ”¿åºœå ±è¡¨æº–ç¢ºæ€§
- **å»ºè­°**: ç›¡å¿«ä¿®æ­£ï¼Œé¿å…ç”¢ç”ŸéŒ¯èª¤çš„å ±è¡¨è³‡æ–™

### æ¸¬è©¦å»ºè­°
1. **å–®å…ƒæ¸¬è©¦**: å»ºç«‹æ¸¬è©¦æ¡ˆä¾‹é©—è­‰æ–°çš„è¨ˆç®—å…¬å¼é‚è¼¯
2. **è¨ˆç®—é©—è­‰**: ç‰¹åˆ¥é©—è­‰ã€Œå¯¦æ‹›æ–°ç”Ÿæ•¸ - å¤–åŠ éŒ„å–åŸä½æ°‘ - å¤–åŠ éŒ„å–èº«å¿ƒéšœç¤™ç”Ÿ - å¤–åŠ éŒ„å–å…¶ä»– - æ ¸å®šç­æ•¸ Ã— æ ¸å®šå­¸ç”Ÿæ•¸ã€çš„è¨ˆç®—çµæœ
3. **æ•´åˆæ¸¬è©¦**: æ¸¬è©¦å®Œæ•´çš„æ–°ç”Ÿåå†Šç”¢ç”Ÿæµç¨‹
4. **è³‡æ–™é©—è­‰**: ç¢ºèª Excel è¼¸å‡ºè³‡æ–™çš„æ­£ç¢ºæ€§ï¼Œç‰¹åˆ¥æ˜¯è¶…æ”¶å­¸ç”Ÿæ•¸æ¬„ä½
5. **å›æ­¸æ¸¬è©¦**: ç¢ºä¿ä¿®æ­£å¾Œä¸å½±éŸ¿å…¶ä»–åŠŸèƒ½
6. **é‚Šç•Œæ¸¬è©¦**: æ¸¬è©¦å„ç¨®æ•¸å€¼çµ„åˆï¼Œç¢ºä¿è¨ˆç®—çµæœæ­£ç¢º

### æ³¨æ„äº‹é …
- ä¿®æ­£å‰è«‹å…ˆå‚™ä»½åŸå§‹ç¨‹å¼ç¢¼
- ä¿®æ­£å¾Œéœ€è¦é€²è¡Œå……åˆ†çš„æ¸¬è©¦
- å»ºè­°åœ¨æ¸¬è©¦ç’°å¢ƒä¸­å…ˆé©—è­‰ä¿®æ­£æ•ˆæœ
- è¨˜éŒ„ä¿®æ­£éç¨‹å’Œæ¸¬è©¦çµæœ

---

## Todo 2: [å¾…æ–°å¢]

---

## å®Œæˆç‹€æ…‹è¿½è¹¤
- [x] Todo 1: ä¿®æ­£ EnrollmentList2021.cs è¨ˆç®—éŒ¯èª¤é¢¨éšª âœ… **å·²å®Œæˆ**
- [ ] Todo 2: [å¾…æ–°å¢]

### æ›´æ–°è¨˜éŒ„
| æ—¥æœŸ | æ›´æ–°å…§å®¹ | æ›´æ–°è€… |
|------|----------|--------|
| 2025-08-22 | å»ºç«‹ Todo æ¸…å–®ï¼Œè¨˜éŒ„è¨ˆç®—éŒ¯èª¤é¢¨éšªå•é¡Œ | ç³»çµ±åˆ†æå¸« |
| 2025-08-22 | å¯¦ä½œ Todo 1ï¼Œä¿®æ­£è¨ˆç®—éŒ¯èª¤é¢¨éšªï¼Œå®Œæˆç¨‹å¼ç¢¼ä¿®æ”¹ | ç³»çµ±åˆ†æå¸« |
